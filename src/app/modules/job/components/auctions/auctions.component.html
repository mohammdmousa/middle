<!-- <div class="card shadow-sm border-0">
  <div class="card-header bg-gradient-primary text-white py-3">
    <div class="d-flex justify-content-between align-items-center">
      <h5 class="m-0 pb-2 fw-semibold">
        <i class="fas fa-gavel me-2"></i> المزادات العلنية
      </h5>
      <a routerLink="/dash/job/addauction" class="btn btn-sm btn-light">
        <i class="fas fa-plus-circle me-1"></i> إضافة مزاد
      </a>
    </div>
  </div>

  <div class="card-filter bg-white p-3 border-bottom">
    <form
      #filterForm="ngForm"
      (submit)="applyFilters()"
      class="row g-3 align-items-end"
    >
      <div class="col-md-2">
        <select
          id="filterCountry"
          class="form-select form-select-sm"
          [(ngModel)]="filters.country_id"
          name="country_id"
          (change)="onCountryFilterChange()"
        >
          <option [ngValue]="null">كل البلدان</option>
          <option *ngFor="let country of countries" [ngValue]="country.id">
            {{ country.ar_name || country.en_name }}
          </option>
        </select>
      </div>

      <div class="col-md-2">
        <select
          id="filterCity"
          class="form-select form-select-sm"
          [(ngModel)]="filters.region_id"
          name="region_id"
          [disabled]="!filters.country_id"
        >
          <option [ngValue]="null">كل المدن</option>
          <option *ngFor="let city of filteredCities" [ngValue]="city.id">
            {{ city.ar_name || city.en_name }}
          </option>
        </select>
      </div>

      <div class="col-md-2">
        <select
          id="filterCategory"
          class="form-select form-select-sm"
          [(ngModel)]="filters.category_id"
          name="category_id"
        >
          <option [ngValue]="null">كل الفئات</option>
          <option
            *ngFor="let category of mainCategories"
            [ngValue]="category.id"
          >
            {{ category.ar_name || category.en_name }}
            <span *ngIf="category.ancestors?.length > 0">
              ({{ getAncestorsNames(category.ancestors) }})
            </span>
          </option>
        </select>
      </div>

      <div class="col-md-2">
        <label for="filterFromDate" class="form-label small fw-bold"
          >من تاريخ</label
        >
        <input
          id="filterFromDate"
          type="date"
          class="form-control form-control-sm"
          [(ngModel)]="filters.start_date"
          name="from_date"
        />
      </div>

      <div class="col-md-2">
        <label for="filterToDate" class="form-label small fw-bold"
          >إلى تاريخ</label
        >
        <input
          id="filterToDate"
          type="date"
          class="form-control form-control-sm"
          [(ngModel)]="filters.end_date"
          name="end_date"
        />
      </div>

      <div class="col-md-2 d-flex">
        <button type="submit" class="btn btn-primary btn-sm me-2 flex-grow-1">
          <i class="fas fa-filter me-1"></i> تطبيق
        </button>
        <button
          type="button"
          class="btn btn-outline-secondary btn-sm"
          (click)="resetFilters()"
        >
          <i class="fas fa-undo me-1"></i> مسح
        </button>
      </div>
    </form>
  </div>

  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th style="width: 80px">ID</th>
            <th>اسم المزاد</th>
            <th>الفئة</th>
            <th>الفئات الفرعية</th>
            <th>البلد</th>
            <th>المدينة</th>
            <th>تاريخ البدء</th>
            <th>تاريخ الانتهاء</th>
            <th>الحالة</th>
            <th style="width: 200px">الإجراءات</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let auction of auctions">
            <tr>
              <td class="fw-semibold">{{ auction.id }}</td>
              <td>{{ auction.name }}</td>
              <td>
                <span class="badge">
                  {{
                    auction.category?.ar_name ||
                      auction.category?.en_name ||
                      "N/A"
                  }}
                </span>
              </td>
              <td>
                <span
                  *ngIf="auction.category?.ancestors?.length > 0"
                  class="ancestors"
                >
                  ({{ getAncestorsNames(auction.category.ancestors) }})
                </span>
              </td>
              <td>
                {{
                  auction.country?.ar_name || auction.country?.en_name || "N/A"
                }}
              </td>
              <td>
                {{
                  auction.region?.ar_name || auction.region?.en_name || "N/A"
                }}
              </td>
              <td>{{ auction.start_date | date : "yyyy/MM/dd" }}</td>
              <td>{{ auction.end_date | date : "yyyy/MM/dd" }}</td>
              <td>{{ auction.status }}</td>
              <td>
                <div class="d-flex">
                  <a
                    [routerLink]="['/dash/job/details', auction.id]"
                    class="btn btn-sm btn-icon btn-outline-info me-1"
                    title="التفاصيل"
                  >
                    <i class="fas fa-eye"></i>
                  </a>
                  <button
                    class="btn btn-sm btn-icon btn-outline-primary me-1"
                    (click)="openEditModal(auction)"
                    title="تعديل"
                  >
                    <i class="far fa-edit"></i>
                  </button>
                  <button
                    class="btn btn-sm btn-icon btn-outline-danger"
                    (click)="deleteAuction(auction.id)"
                    title="حذف"
                  >
                    <i class="far fa-trash-alt"></i>
                  </button>
                </div>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
  </div>

  <div class="card-footer d-flex justify-content-between align-items-center">
    <div class="text-muted small">
      عرض {{ (currentPage - 1) * perPage + 1 }} إلى
      {{
        currentPage * perPage > totalItems ? totalItems : currentPage * perPage
      }}
      من أصل {{ totalItems }} مزاد
    </div>

    <nav aria-label="Page navigation">
      <ul class="pagination mb-0">
        <li class="page-item" [class.disabled]="currentPage == 1">
          <a
            class="page-link"
            href="javascript:void(0)"
            (click)="goToPage('prev')"
          >
            &laquo; السابق
          </a>
        </li>

        <ng-container *ngFor="let link of links">
          <li
            *ngIf="isNumericLink(link)"
            class="page-item"
            [class.active]="link.active"
            [class.disabled]="link.url === null"
          >
            <a
              class="page-link"
              href="javascript:void(0)"
              (click)="goToPage(link.label)"
            >
              {{ link.label }}
            </a>
          </li>
        </ng-container>

        <li class="page-item" [class.disabled]="currentPage === lastPage">
          <a
            class="page-link"
            href="javascript:void(0)"
            (click)="goToPage('next')"
          >
            التالي &raquo;
          </a>
        </li>
      </ul>
    </nav>
  </div>
  <button class="btn btn-primary mt-3" (click)="exportToExcel()">
    <i class="fas fa-file-excel me-2"></i> تصدير إلى إكسل
  </button>

  <div
    class="modal fade"
    id="editAuctionModal"
    tabindex="-1"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title d-flex align-items-center">
            <i class="fas fa-edit me-2"></i> تعديل مزاد
          </h5>
          <button
            type="button"
            class="btn-close btn-close-white"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>

        <div class="modal-body p-4">
          <form #editForm="ngForm" (ngSubmit)="updateAuction()">
            <div class="card border-0 shadow-sm mb-4">
              <div class="card-header bg-light">
                <h5 class="mb-0">
                  <i class="fas fa-info-circle me-2 text-primary"></i>
                  المعلومات الأساسية
                </h5>
              </div>
              <div class="card-body">
                <div class="row g-3">
                  <div class="col-md-6">
                    <label for="editName" class="form-label fw-bold">
                      اسم المزاد <span class="text-danger">*</span>
                    </label>
                    <input
                      type="text"
                      class="form-control border-2 py-2"
                      id="editName"
                      [(ngModel)]="selectedAuction.name"
                      name="name"
                      required
                    />
                  </div>

                  <div class="col-md-6">
                    <label for="editStatus" class="form-label fw-bold">
                      حالة المزاد <span class="text-danger">*</span>
                    </label>
                    <select
                      class="form-control border-2 py-2"
                      id="editStatus"
                      [(ngModel)]="selectedAuction.status"
                      name="status"
                      required
                    >
                      <option value="pending">قيد الانتظار</option>
                      <option value="active">نشط</option>
                      <option value="completed">مكتمل</option>
                    </select>
                  </div>

                  <div class="col-md-6">
                    <label for="editCategory" class="form-label fw-bold">
                      الفئة <span class="text-danger">*</span>
                    </label>
                    <select
                      class="form-control border-2 py-2"
                      id="editCategory"
                      [(ngModel)]="selectedAuction.category_id"
                      name="category_id"
                      required
                      (change)="loadCustomFields(selectedAuction.category_id)"
                    >
                      <option [ngValue]="null" disabled>اختر الفئة</option>
                      <option
                        *ngFor="let cat of mainCategories"
                        [ngValue]="cat.id"
                      >
                        {{ cat.ar_name || cat.en_name }}
                      </option>
                    </select>
                  </div>

                  <div class="col-12">
                    <label for="editDescription" class="form-label fw-bold">
                      الوصف
                    </label>
                    <textarea
                      class="form-control border-2 py-2"
                      id="editDescription"
                      [ngModel]="getPlainDescription()"
                      (ngModelChange)="setPlainDescription($event)"
                      name="description"
                      rows="3"
                    ></textarea>
                  </div>
                </div>
              </div>
            </div>

            <div class="card border-0 shadow-sm mb-4">
              <div class="card-header bg-light">
                <h5 class="mb-0">
                  <i class="fas fa-map-marker-alt me-2 text-primary"></i>
                  الموقع والوقت
                </h5>
              </div>
              <div class="card-body">
                <div class="row g-3">
                  <div class="col-md-6">
                    <label for="editCountry" class="form-label fw-bold">
                      البلد <span class="text-danger">*</span>
                    </label>
                    <select
                      class="form-control border-2 py-2"
                      id="editCountry"
                      [(ngModel)]="selectedAuction.country_id"
                      name="country_id"
                      required
                      (change)="onCountryChange(selectedAuction.country_id)"
                    >
                      <option [ngValue]="null" disabled>اختر البلد</option>
                      <option
                        *ngFor="let country of countries"
                        [ngValue]="country.id"
                      >
                        {{ country.ar_name || country.en_name }}
                      </option>
                    </select>
                  </div>

                  <div class="col-md-6">
                    <label for="editRegion" class="form-label fw-bold">
                      المدينة <span class="text-danger">*</span>
                    </label>
                    <select
                      class="form-control border-2 py-2"
                      id="editRegion"
                      [(ngModel)]="selectedAuction.region_id"
                      name="region_id"
                      required
                      [disabled]="!selectedAuction.country_id"
                    >
                      <option [ngValue]="null" disabled>اختر المدينة</option>
                      <option
                        *ngFor="let region of cities"
                        [ngValue]="region.id"
                      >
                        {{ region.ar_name || region.en_name }}
                      </option>
                    </select>
                  </div>

                  <div class="row mb-3">
                    <div class="col-md-6">
                      <label for="editLatitude" class="form-label fw-bold">
                        خط العرض
                      </label>
                      <div class="input-group">
                        <input
                          type="text"
                          class="form-control border-2 py-2"
                          id="editLatitude"
                          [(ngModel)]="selectedAuction.latitude"
                          name="latitude"
                          placeholder="24.7136"
                          readonly
                        />
                        <button
                          class="btn btn-outline-secondary"
                          type="button"
                          (click)="openMapModal()"
                        >
                          <i class="fas fa-map-marked-alt"></i>
                        </button>
                      </div>
                    </div>

                    <div class="col-md-6">
                      <label for="editLongitude" class="form-label fw-bold">
                        خط الطول
                      </label>
                      <input
                        type="text"
                        class="form-control border-2 py-2"
                        id="editLongitude"
                        [(ngModel)]="selectedAuction.longitude"
                        name="longitude"
                        placeholder="46.6753"
                        readonly
                      />
                    </div>
                  </div>

                  <div class="mb-3" *ngIf="selectedAuction.location">
                    <label class="form-label fw-bold">العنوان:</label>
                    <div class="p-2 bg-light rounded">
                      {{ selectedAuction.location }}
                    </div>
                  </div>

                  <div class="col-md-6">
                    <label for="editStartDate" class="form-label fw-bold">
                      تاريخ البدء <span class="text-danger">*</span>
                    </label>
                    <input
                      type="datetime-local"
                      class="form-control border-2 py-2"
                      id="editStartDate"
                      [(ngModel)]="selectedAuction.start_date"
                      name="start_date"
                      required
                    />
                  </div>

                  <div class="col-md-6">
                    <label for="editEndDate" class="form-label fw-bold">
                      تاريخ الانتهاء <span class="text-danger">*</span>
                    </label>
                    <input
                      type="datetime-local"
                      class="form-control border-2 py-2"
                      id="editEndDate"
                      [(ngModel)]="selectedAuction.end_date"
                      name="end_date"
                      required
                    />
                  </div>
                </div>
              </div>
            </div>

            <div class="card border-0 shadow-sm mb-4">
              <div class="card-header bg-light">
                <h5 class="mb-0">
                  <i class="fas fa-phone-alt me-2 text-primary"></i>
                  طرق التواصل
                </h5>
              </div>
              <div class="card-body">
                <div class="row g-3">
                  <div class="col-md-6">
                    <label for="editPhone" class="form-label fw-bold">
                      رقم الهاتف
                    </label>
                    <input
                      type="tel"
                      class="form-control border-2 py-2"
                      id="editPhone"
                      [(ngModel)]="selectedAuction.phone"
                      name="phone"
                    />
                  </div>
                  <div class="col-md-6">
                    <label for="editWhatsapp" class="form-label fw-bold">
                      واتساب
                    </label>
                    <input
                      type="tel"
                      class="form-control border-2 py-2"
                      id="editWhatsapp"
                      [(ngModel)]="selectedAuction.whatsapp"
                      name="whatsapp"
                    />
                  </div>
                  <div class="col-12">
                    <label for="editEmail" class="form-label fw-bold">
                      البريد الإلكتروني
                    </label>
                    <input
                      type="email"
                      class="form-control border-2 py-2"
                      id="editEmail"
                      [(ngModel)]="selectedAuction.email"
                      name="email"
                    />
                  </div>
                </div>
              </div>
            </div>

            <div class="card border-0 shadow-sm mb-4">
              <div class="card-header bg-light">
                <h5 class="mb-0">
                  <i class="fas fa-images me-2 text-primary"></i> صور المزاد
                </h5>
              </div>
              <div class="card-body">
                <div class="row">
                  <div
                    class="col-md-3 col-6 mb-3"
                    *ngFor="let image of selectedAuction.images; let i = index"
                  >
                    <div class="image-thumbnail-container">
                      <img
                        [src]="image.url || url + image.image_path"
                        class="img-thumbnail rounded"
                        alt="صورة المزاد"
                      />
                      <button
                        type="button"
                        class="btn btn-danger btn-sm remove-image-btn"
                        (click)="removeImage(i, image.id)"
                      >
                        <i class="fas fa-times"></i>
                      </button>
                    </div>
                  </div>

                  <div class="col-md-3 col-6">
                    <div
                      class="h-100 d-flex align-items-center justify-content-center"
                    >
                      <label
                        class="btn btn-outline-primary cursor-pointer w-100 h-100 d-flex flex-column align-items-center justify-content-center"
                      >
                        <i class="fas fa-plus mb-2"></i>
                        <span>إضافة صورة</span>
                        <input
                          type="file"
                          class="d-none"
                          (change)="onImageUpload($event)"
                          accept="image/*"
                          multiple
                          [disabled]="isLoading"
                        />
                      </label>
                    </div>
                  </div>

                  <div *ngIf="isLoading" class="col-12 text-center mt-3">
                    <div class="spinner-border text-primary" role="status">
                      <span class="visually-hidden">جاري التحميل...</span>
                    </div>
                    <p class="mt-2">جاري رفع الصور...</p>
                  </div>
                </div>
              </div>
            </div>

            <div class="modal-footer border-0 pt-4 px-0">
              <button
                type="button"
                class="btn btn-outline-secondary px-4 py-2"
                data-bs-dismiss="modal"
              >
                <i class="fas fa-times me-1"></i> إلغاء
              </button>
              <button
                type="submit"
                class="btn btn-primary px-4 py-2"
                [disabled]="!editForm.valid"
              >
                <i class="fas fa-save me-1"></i> حفظ التغييرات
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div> -->

<div class="card shadow-sm border-0">
  <!-- Card Header -->
  <div class="card-header bg-gradient-primary text-white py-3">
    <div class="d-flex justify-content-between align-items-center">
      <h5 class="m-0 pb-2 fw-semibold">
        <i class="fas fa-gavel me-2"></i> Public Auctions
      </h5>
      <button class="btn btn-sm btn-light d-block" (click)="exportToExcel()">
        <i class="fas fa-file-excel me-1"></i> Export To Excel
      </button>
    </div>
    <div class="box d-flex justify-content-end mt-2">
      <a routerLink="/dash/job/addauction" class="btn btn-sm btn-light">
        <i class="fas fa-plus-circle me-1"></i> Add Auction
      </a>
    </div>
  </div>

  <!-- Filter Section -->
  <div class="card-filter bg-white p-3 border-bottom">
    <form
      #filterForm="ngForm"
      (submit)="applyFilters()"
      class="row g-3 align-items-end"
    >
      <!-- Country Filter -->
      <div class="col-md-2">
        <select
          id="filterCountry"
          class="form-select form-select-sm"
          [(ngModel)]="filters.country_id"
          name="country_id"
          (change)="onCountryFilterChange()"
        >
          <option [ngValue]="null">All Countries</option>
          <option *ngFor="let country of countries" [ngValue]="country.id">
            {{ country.en_name || country.ar_name }}
          </option>
        </select>
      </div>

      <!-- City Filter -->
      <div class="col-md-2">
        <select
          id="filterCity"
          class="form-select form-select-sm"
          [(ngModel)]="filters.region_id"
          name="region_id"
          [disabled]="!filters.country_id"
        >
          <option [ngValue]="null">All Cities</option>
          <option *ngFor="let city of filteredCities" [ngValue]="city.id">
            {{ city.en_name || city.ar_name }}
          </option>
        </select>
      </div>

      <!-- Category Filter -->
      <div class="col-md-2">
        <select
          id="filterCategory"
          class="form-select form-select-sm"
          [(ngModel)]="filters.category_id"
          name="category_id"
        >
          <option [ngValue]="null">All Categories</option>
          <option
            *ngFor="let category of mainCategories"
            [ngValue]="category.id"
          >
            {{ category.en_name || category.ar_name }}
            <span *ngIf="category.ancestors?.length > 0">
              ({{ getAncestorsNames(category.ancestors) }})
            </span>
          </option>
        </select>
      </div>

      <!-- Date From Filter -->
      <div class="col-md-2">
        <label for="filterFromDate" class="form-label small fw-bold"
          >From Date</label
        >
        <input
          id="filterFromDate"
          type="date"
          class="form-control form-control-sm"
          [(ngModel)]="filters.start_date"
          name="from_date"
        />
      </div>

      <div class="col-md-2">
        <label for="filterToDate" class="form-label small fw-bold"
          >To Date</label
        >
        <input
          id="filterToDate"
          type="date"
          class="form-control form-control-sm"
          [(ngModel)]="filters.end_date"
          name="end_date"
        />
      </div>

      <!-- Filter Buttons -->
      <div class="col-md-2 d-flex">
        <button type="submit" class="btn btn-primary btn-sm me-2 flex-grow-1">
          <i class="fas fa-filter me-1"></i> Apply
        </button>
        <button
          type="button"
          class="btn btn-outline-secondary btn-sm"
          (click)="resetFilters()"
        >
          <i class="fas fa-undo me-1"></i> Reset
        </button>
      </div>
    </form>
  </div>

  <!-- Auctions Table -->
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th style="width: 80px">ID</th>
            <th>Auction Name</th>
            <th>Category</th>
            <th>Subcategories</th>
            <th>Country</th>
            <th>City</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Status</th>
            <th style="width: 200px">Actions</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let auction of auctions">
            <tr>
              <td class="fw-semibold">{{ auction.id }}</td>
              <td>{{ auction.name }}</td>
              <td>
                <span class="badge">
                  {{
                    auction.category?.en_name ||
                      auction.category?.ar_name ||
                      "N/A"
                  }}
                </span>
              </td>
              <td>
                <span
                  *ngIf="auction.category?.ancestors?.length > 0"
                  class="ancestors"
                >
                  ({{ getAncestorsNames(auction.category.ancestors) }})
                </span>
              </td>
              <td>
                {{
                  auction.country?.en_name || auction.country?.ar_name || "N/A"
                }}
              </td>
              <td>
                {{
                  auction.region?.en_name || auction.region?.ar_name || "N/A"
                }}
              </td>
              <td>{{ auction.start_date | date : "yyyy/MM/dd" }}</td>
              <td>{{ auction.end_date | date : "yyyy/MM/dd" }}</td>
              <td>{{ auction.status }}</td>
              <td>
                <div class="d-flex">
                  <a
                    [routerLink]="['/dash/job/details', auction.id]"
                    class="btn btn-sm btn-icon btn-outline-info me-1"
                    title="Details"
                  >
                    <i class="fas fa-eye"></i>
                  </a>
                  <button
                    class="btn btn-sm btn-icon btn-outline-primary me-1"
                    (click)="openEditModal(auction)"
                    title="Edit"
                  >
                    <i class="far fa-edit"></i>
                  </button>
                  <button
                    class="btn btn-sm btn-icon btn-outline-danger"
                    (click)="deleteAuction(auction.id)"
                    title="Delete"
                  >
                    <i class="far fa-trash-alt"></i>
                  </button>
                </div>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Pagination -->
  <div class="card-footer d-flex justify-content-between align-items-center">
    <div class="text-muted small">
      Showing {{ (currentPage - 1) * perPage + 1 }} to
      {{
        currentPage * perPage > totalItems ? totalItems : currentPage * perPage
      }}
      of {{ totalItems }} auctions
    </div>

    <nav aria-label="Page navigation">
      <ul class="pagination mb-0">
        <!-- Previous Button -->
        <li class="page-item" [class.disabled]="currentPage == 1">
          <a
            class="page-link"
            href="javascript:void(0)"
            (click)="goToPage('prev')"
          >
            &laquo; Previous
          </a>
        </li>

        <!-- Numeric Page Links -->
        <ng-container *ngFor="let link of links">
          <li
            *ngIf="isNumericLink(link)"
            class="page-item"
            [class.active]="link.active"
            [class.disabled]="link.url === null"
          >
            <a
              class="page-link"
              href="javascript:void(0)"
              (click)="goToPage(link.label)"
            >
              {{ link.label }}
            </a>
          </li>
        </ng-container>

        <!-- Next Button -->
        <li class="page-item" [class.disabled]="currentPage === lastPage">
          <a
            class="page-link"
            href="javascript:void(0)"
            (click)="goToPage('next')"
          >
            Next &raquo;
          </a>
        </li>
      </ul>
    </nav>
  </div>

  <!-- Edit Modal -->
  <div
    class="modal fade"
    id="editAuctionModal"
    tabindex="-1"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title d-flex align-items-center">
            <i class="fas fa-edit me-2"></i> Edit Auction
          </h5>
          <button
            type="button"
            class="btn-close btn-close-white"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>

        <div class="modal-body p-4">
          <form #editForm="ngForm" (ngSubmit)="updateAuction()">
            <!-- Section 1: Basic Information -->
            <div class="card border-0 shadow-sm mb-4">
              <div class="card-header bg-light">
                <h5 class="mb-0">
                  <i class="fas fa-info-circle me-2 text-primary"></i>
                  Basic Information
                </h5>
              </div>
              <div class="card-body">
                <div class="row g-3">
                  <!-- Auction Name -->
                  <div class="col-md-6">
                    <label for="editName" class="form-label fw-bold">
                      Auction Name <span class="text-danger">*</span>
                    </label>
                    <input
                      type="text"
                      class="form-control border-2 py-2"
                      id="editName"
                      [(ngModel)]="selectedAuction.name"
                      name="name"
                      required
                    />
                  </div>

                  <!-- Auction Status -->
                  <div class="col-md-6">
                    <label for="editStatus" class="form-label fw-bold">
                      Status <span class="text-danger">*</span>
                    </label>
                    <select
                      class="form-control border-2 py-2"
                      id="editStatus"
                      [(ngModel)]="selectedAuction.status"
                      name="status"
                      required
                    >
                      <option value="pending">Pending</option>
                      <option value="active">Active</option>
                      <option value="completed">Completed</option>
                    </select>
                  </div>

                  <!-- Category -->
                  <div class="col-md-6">
                    <label for="editCategory" class="form-label fw-bold">
                      Category <span class="text-danger">*</span>
                    </label>
                    <select
                      class="form-control border-2 py-2"
                      id="editCategory"
                      [(ngModel)]="selectedAuction.category_id"
                      name="category_id"
                      required
                      (change)="loadCustomFields(selectedAuction.category_id)"
                    >
                      <option [ngValue]="null" disabled>Select Category</option>
                      <option
                        *ngFor="let cat of mainCategories"
                        [ngValue]="cat.id"
                      >
                        {{ cat.en_name || cat.ar_name }}
                      </option>
                    </select>
                  </div>

                  <!-- Description -->
                  <div class="col-12">
                    <label for="editDescription" class="form-label fw-bold">
                      Description
                    </label>
                    <textarea
                      class="form-control border-2 py-2"
                      id="editDescription"
                      [ngModel]="getPlainDescription()"
                      (ngModelChange)="setPlainDescription($event)"
                      name="description"
                      rows="3"
                    ></textarea>
                  </div>
                </div>
              </div>
            </div>

            <!-- Section 2: Location & Time -->
            <div class="card border-0 shadow-sm mb-4">
              <div class="card-header bg-light">
                <h5 class="mb-0">
                  <i class="fas fa-map-marker-alt me-2 text-primary"></i>
                  Location & Time
                </h5>
              </div>
              <div class="card-body">
                <div class="row g-3">
                  <!-- Country -->
                  <div class="col-md-6">
                    <label for="editCountry" class="form-label fw-bold">
                      Country <span class="text-danger">*</span>
                    </label>
                    <select
                      class="form-control border-2 py-2"
                      id="editCountry"
                      [(ngModel)]="selectedAuction.country_id"
                      name="country_id"
                      required
                      (change)="onCountryChange(selectedAuction.country_id)"
                    >
                      <option [ngValue]="null" disabled>Select Country</option>
                      <option
                        *ngFor="let country of countries"
                        [ngValue]="country.id"
                      >
                        {{ country.en_name || country.ar_name }}
                      </option>
                    </select>
                  </div>

                  <!-- City -->
                  <div class="col-md-6">
                    <label for="editRegion" class="form-label fw-bold">
                      City <span class="text-danger">*</span>
                    </label>
                    <select
                      class="form-control border-2 py-2"
                      id="editRegion"
                      [(ngModel)]="selectedAuction.region_id"
                      name="region_id"
                      required
                      [disabled]="!selectedAuction.country_id"
                    >
                      <option [ngValue]="null" disabled>Select City</option>
                      <option
                        *ngFor="let region of cities"
                        [ngValue]="region.id"
                      >
                        {{ region.en_name || region.ar_name }}
                      </option>
                    </select>
                  </div>

                  <!-- Coordinates -->
                  <div class="row mb-3">
                    <div class="col-md-6">
                      <label for="editLatitude" class="form-label fw-bold">
                        Latitude
                      </label>
                      <div class="input-group">
                        <input
                          type="text"
                          class="form-control border-2 py-2"
                          id="editLatitude"
                          [(ngModel)]="selectedAuction.latitude"
                          name="latitude"
                          placeholder="24.7136"
                          readonly
                        />
                        <button
                          class="btn btn-outline-secondary"
                          type="button"
                          (click)="openMapModal()"
                        >
                          <i class="fas fa-map-marked-alt"></i>
                        </button>
                      </div>
                    </div>

                    <div class="col-md-6">
                      <label for="editLongitude" class="form-label fw-bold">
                        Longitude
                      </label>
                      <input
                        type="text"
                        class="form-control border-2 py-2"
                        id="editLongitude"
                        [(ngModel)]="selectedAuction.longitude"
                        name="longitude"
                        placeholder="46.6753"
                        readonly
                      />
                    </div>
                  </div>

                  <div class="mb-3" *ngIf="selectedAuction.location">
                    <label class="form-label fw-bold">Address:</label>
                    <div class="p-2 bg-light rounded">
                      {{ selectedAuction.location }}
                    </div>
                  </div>

                  <!-- Dates -->
                  <div class="col-md-6">
                    <label for="editStartDate" class="form-label fw-bold">
                      Start Date <span class="text-danger">*</span>
                    </label>
                    <input
                      type="datetime-local"
                      class="form-control border-2 py-2"
                      id="editStartDate"
                      [(ngModel)]="selectedAuction.start_date"
                      name="start_date"
                      required
                    />
                  </div>

                  <div class="col-md-6">
                    <label for="editEndDate" class="form-label fw-bold">
                      End Date <span class="text-danger">*</span>
                    </label>
                    <input
                      type="datetime-local"
                      class="form-control border-2 py-2"
                      id="editEndDate"
                      [(ngModel)]="selectedAuction.end_date"
                      name="end_date"
                      required
                    />
                  </div>
                </div>
              </div>
            </div>

            <!-- Section 3: Contact Information -->
            <div class="card border-0 shadow-sm mb-4">
              <div class="card-header bg-light">
                <h5 class="mb-0">
                  <i class="fas fa-phone-alt me-2 text-primary"></i>
                  Contact Information
                </h5>
              </div>
              <div class="card-body">
                <div class="row g-3">
                  <div class="col-md-6">
                    <label for="editPhone" class="form-label fw-bold">
                      Phone Number
                    </label>
                    <input
                      type="tel"
                      class="form-control border-2 py-2"
                      id="editPhone"
                      [(ngModel)]="selectedAuction.phone"
                      name="phone"
                    />
                  </div>
                  <div class="col-md-6">
                    <label for="editWhatsapp" class="form-label fw-bold">
                      WhatsApp
                    </label>
                    <input
                      type="tel"
                      class="form-control border-2 py-2"
                      id="editWhatsapp"
                      [(ngModel)]="selectedAuction.whatsapp"
                      name="whatsapp"
                    />
                  </div>
                  <div class="col-12">
                    <label for="editEmail" class="form-label fw-bold">
                      Email
                    </label>
                    <input
                      type="email"
                      class="form-control border-2 py-2"
                      id="editEmail"
                      [(ngModel)]="selectedAuction.email"
                      name="email"
                    />
                  </div>
                </div>
              </div>
            </div>

            <!-- Section 4: Images -->
            <div class="card border-0 shadow-sm mb-4">
              <div class="card-header bg-light">
                <h5 class="mb-0">
                  <i class="fas fa-images me-2 text-primary"></i> Auction Images
                </h5>
              </div>
              <div class="card-body">
                <div class="row">
                  <!-- Current Images -->
                  <div
                    class="col-md-3 col-6 mb-3"
                    *ngFor="let image of selectedAuction.images; let i = index"
                  >
                    <div class="image-thumbnail-container">
                      <img
                        [src]="image.url || url + image.image_path"
                        class="img-thumbnail rounded"
                        alt="Auction Image"
                      />
                      <button
                        type="button"
                        class="btn btn-danger btn-sm remove-image-btn"
                        (click)="removeImage(i, image.id)"
                      >
                        <i class="fas fa-times"></i>
                      </button>
                    </div>
                  </div>

                  <!-- Add Image Button -->
                  <div class="col-md-3 col-6">
                    <div
                      class="h-100 d-flex align-items-center justify-content-center"
                    >
                      <label
                        class="btn btn-outline-primary cursor-pointer w-100 h-100 d-flex flex-column align-items-center justify-content-center"
                      >
                        <i class="fas fa-plus mb-2"></i>
                        <span>Add Image</span>
                        <input
                          type="file"
                          class="d-none"
                          (change)="onImageUpload($event)"
                          accept="image/*"
                          multiple
                          [disabled]="isLoading"
                        />
                      </label>
                    </div>
                  </div>

                  <!-- Loading Indicator -->
                  <div *ngIf="isLoading" class="col-12 text-center mt-3">
                    <div class="spinner-border text-primary" role="status">
                      <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="mt-2">Uploading images...</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Control Buttons -->
            <div class="modal-footer border-0 pt-4 px-0">
              <button
                type="button"
                class="btn btn-outline-secondary px-4 py-2"
                data-bs-dismiss="modal"
              >
                <i class="fas fa-times me-1"></i> Cancel
              </button>
              <button
                type="submit"
                class="btn btn-primary px-4 py-2"
                [disabled]="!editForm.valid"
              >
                <i class="fas fa-save me-1"></i> Save Changes
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
